\documentclass[hyperref={colorlinks, citecolor=blue}]{beamer}
\usepackage{float,times,graphicx,mathtools}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{latexsym}
\usepackage{epsfig}
\usepackage{graphicx}
\usepackage{color}
\usepackage{pdfpages}
\usepackage{natbib}
\usepackage{setspace}
\usepackage{multirow}
\usepackage{bbm}
\usepackage{MnSymbol,wasysym}
\usepackage{tensor}
\usepackage{tikz}

\usetikzlibrary{arrows,decorations.pathmorphing,backgrounds,positioning,fit,petri,calc,shadows}

\setbeamertemplate{caption}{\raggedright\insertcaption\par}
\usefonttheme{serif}
\onehalfspacing

\title{Incorporating Mortality Estimation into Population Reconstruction}

\begin{document}

\frame{\titlepage}

\begin{frame}
\frametitle{Brief Introduction to Mortality Modelling}
Let $T$ be the time (number of years) to death of a newborn (i.e. aged $0$), we have
\begin{align*}
_tq_x = P(T \leq t+x | T > x),
\end{align*}
 i.e. the probability that the newborn will die \textit{within} $t$ years given that she has survived for $x$ years, 

then $_tp_x = 1 - \, _tq_x = P(T \geq t+x | T > x)$ is the probability that an individual aged $x$ will survive \textit{at least} $t$ years.
\end{frame}

\begin{frame}
\frametitle{Force of Mortality \textit{vs} Death Probabilities}
Force of mortality is defined as:
\begin{align*}
\mu_{x+t} &= \lim_{\delta t \to 0} \frac{P(T \leq x+t+\delta t	| T > x+t)}{\delta t},	\\
					&= - \frac{1}{\tensor[_t]{p}{_x}}\frac{d}{dt} \tensor[_t]{p}{_x}, \\
					&= -\frac{d}{dt} \log \tensor[_t]{p}{_x}, \\
					\implies \tensor[_t]{q}{_x} &= 1- \tensor[_t]{p}{_x} = 1 - e^{- \int^t_0 \mu_{x+s} \, ds}.
\end{align*}
Intuitively it can be thought as a measure of the instantaneous ``death probability'' at age $x+t$. 
\begin{itemize}
\item the force of mortality is a \textit{rate}, $\mu \in [0, \infty)$
\item the death probability is a \textit{probability}, $\q \in [0, 1]$
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Central Mortality Rates}
It is often impossible to model directly on $\mu$. A usual practice is to aggregate data into separate age groups (usually 1 year), with mortality measured by the \textit{central mortality rates}:
\begin{align*}
_1m_{x} = m_x = \frac{\int^1_0 E_{x+t} \mu_{x+t} \,dt}{\int^1_0 E_{x+t} \,dt} = \frac{\mathbbm{E}(_1d_x)}{_1E^C_x}
\end{align*}
where $_1E^C_x$ and $_1d_x$ are the central exposures and number of deaths in age $[x, x+1)$ in 1 year. 
\begin{itemize}
\item Intuitively the central mortality rate can be viewed as the average force of mortality weighted by the corresponding exposures
\item Most mortality modelling is done on $m_x$.
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Conversion between $\mu_x$, $m_x$ and $q_x$}
As mentioned before, the exact relationship between $\mu_x$ and $q_x$ is $\tensor[_t]{q}{_x} &= 1 - e^{- \int^t_0 \mu_{x+s} \, ds}$, however, this requires integration over the age range. Often simplifying assumptions are made, two common ones are:
\begin{itemize}
\item[1)] Constant force of mortality $\rightarrow$ the force of mortality is constant within the age group \\
$\implies {q}{_x}  = 1 - e^{-\mu_{x+0.5}} \approx 1 - e^{-m_x}$
\item[2)] Uniform distribution of deaths $\rightarrow$ deaths are uniformly distributed over age range \\
$\implies {q}{_x} = \frac{m_x}{1 + 0.5 m_x}$
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Mortality Models}
Recall 
\begin{align*}
m_x = \frac{\mathbbm{E}(d_x)}{E^C_x} \implies \mathbbm{E}(d_x) = E^C_x \, m_x
\end{align*}
Since $d_x$ is a count variable, it is often modelled as Poisson distributions, i.e. $d_x \sim Poisson(E^C_x \, m_x)$. Alternatives include
\begin{itemize}
\item $d_x \sim Binomial(E^0_x, q_x), $ where $E^0_x$ is the initial exposures
\item $\log(m_x) \sim N(\log(\hat{m_x}), \sigma), $ where $\hat{m_x}$ is the crude mortality rates

\item the Poisson distribution is often too restrictive as $Var(d_x) = \mathbbm{E}(d_x)$, and over-dispersion usually presents in mortality data.
\begin{itemize}
\item[\hookrightarrow] introduce an extra parameter of specific form to capture the excessive variance, one arrives at a Negative Binomial distribution, i.e. $d_x \sim NegBinom(E^C_x \, m_x, s)$
\end{itemize}
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Mortality Models}
Typical non-HIV infected mortality schedules, England and Wales males and females \footnote[frame]{Data obtained from the Office for National Statistics}
\newline
\includegraphics[width=\linewidth]{Graphs/crude mort rates.png}
\end{frame}

\begin{frame}
\frametitle{Mortality Models}
\begin{columns}
\begin{column}{0.4\linewidth}
\includegraphics[width=\linewidth]{Graphs/crude mort rates 2011.jpg}
\end{column}
\begin{column}{0.7\linewidth}
\begin{itemize}
\item male mortality (blue) is higher than female mortality (red) most of the time
\item infant mortality is exceptionally high, followed by a sharp decrease into early teens
\item humps can be observed at late teens to early adulthood, more prominent for males (accident hump / maternal hump)
\item mortality increases steadily and relatively log-linearly after the mortality humps into older ages due to senescence
\end{itemize}
\end{column}
\end{columns}
\end{frame}

\begin{frame}
\frametitle{Mortality Models}
One of the earliest attempts in mortality modelling dates back to 1825, the Gompertz law of mortality \citep{gompertz1825on},
\begin{align*}
\log (m_x) = a + bx,
\end{align*}
which is then modified to the Gompertz-Makeham law \citep{makeham1860law} with the addition of an age invariant background mortality constant (age-unrelated deaths such as accidents)
\begin{align*}
m_x = A + BC^x
\end{align*}
\begin{itemize}
\item relatively simple, with only few parameters
\item provides adequate fit to mortality at older ages
\item only applicable to older ages, due to the log-linearity assumption
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Mortality Models}
The mortality schedules often deviate from the log-linearity and level-off (mortality plateau) at the oldest ages (approx after 92, \citeauthor{carriere1992parametric}, \citeyear{carriere1992parametric}). \citet{perks1932some}, \citet{beard1959note} and \citet{thatcher1999long} proposed logistic models of the form
\begin{equation*}
 m_x = \frac{c z}{1+z} + \gamma
	\end{equation*}
\begin{itemize}
\item at younger ages the logistic curve behaves similarly to a log-linear curve
\item at the oldest ages provides a level-off to an asymptote
\item again only applicable to older ages
\item other attempts to capture the mortality plateau include \citet{coale1990defects}, \citet{lindbergson2001mortality}
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Mortality Models}
Full age range models require relatively complicated forms due to the peculiar shape of mortality age patterns. 
\\~\\
Several parametric models have been proposed which share a similar concept - decomposition of mortality into different stages: child mortality, young adult mortality and senescence, e.g. \citet{thiele1871mathematical}, \citet{heligman1980age}, \citet{siler1983parameters} and \citet{carriere1992parametric}. 
\\~\\
Some non-parameteric models have also been developed, but I will not be discussing them here.
\end{frame}

\begin{frame}
\frametitle{Mortality Models}
Among them, the Heligman-Pollard model \citep{heligman1980age} is probably the most popular:
\begin{equation*}
	\frac{q_x}{1-q_x} = A^{(x + B)^C} + D e^{-E(ln x - ln F)^2} + GH^x,
\end{equation*}

\begin{itemize}
\item 8 interpretable parameters
\item suitable for the whole age range
\item some variants also proposed in \citet{heligman1980age}
\item very high correlation among parameters during estimation, adding difficulties
\item the high correlation also compromises the interpretability
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Mortality Models}
\begin{figure}
\includegraphics[height=0.7\textheight]{Graphs/HP model.png}
\caption{Decomposition of the HP model \footnote[frame]{Source: \citet{sharrow2013age}}}
\end{figure}
\end{frame}

\begin{frame}
\frametitle{Mortality Models}
Alternative to parametric mortality laws, several model life table systems have also been developed and widely used, such as the Coale-Demeny family \citep{coale1966regional}. Some organisations have also produced their own life table system, e.g. UN, GBD. 
\\~\\
These systems often use a few summary indices such as the child mortality $_5q_0$ , life expectancy at birth $\mathring{e}_0$, adult mortality $_{45}q_{15}$ etc. to generate full mortality schedules.
\end{frame}

\begin{frame}
\frametitle{Mortality Models}
A more recent model life table system is developed by \citet{wilmoth2012flexible} which has 2 parameters, namely the Log Quadratic (LogQuad) model (still somehow parameteric I guess...):
\begin{align*}
\log(m_x) = a_x + b_x \, h + c_x \, h^2 + v_x \, k,
\end{align*}
where $a_x$, $b_x$, $c_x$ and $v_x$ are constants derived from a set of life tables using SVD and $h$ and $k$ are the 2 effective parameters to vary. In addition, $h = \log(_5q_0)$, therefore given a fixed level of child mortality, a full schedule can be generated.
\end{frame}

\begin{frame}
\frametitle{Life Tables}
\begin{columns}
\column{0.5\linewidth}
\begin{figure}
\includegraphics[width=0.95\linewidth]{Graphs/ELT15 snap.jpeg}
\caption{English Life Table 15 males \footnote[frame]{Source: Formulae and Tables for The Institute and Faculty of Actuaries}}
\end{figure}
\column{0.7\linewidth}
\begin{figure}
\includegraphics[width=1.2\linewidth]{Graphs/ELT17 males snap.png}
\caption{English Life Table 17 males \footnote[frame]{Source: \citet{dodd2018smoothing}}}
\end{figure}
\end{columns}
\\~\\
\begin{itemize}
\item information included may vary from tables to tables
\item columns can be derived from each other
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Bayesian Population Reconstruction}
Two main approaches:
\begin{itemize}
\item prospective reconstruction (``inverse projection'')
	\begin{itemize}
	\item[\hookrightarrow] start with a ``baseline population'' at the initial time period and project and reconstruct the population forward with corresponding demographics rates
	\end{itemize}
\item retrospective reconstruction (``back projection'')
	\begin{itemize}
	\item[\hookrightarrow] start with a final population at the terminal time period and propagate backwards in time
	\item[\hookrightarrow] however, there was debates about the efficacy of this approach as it is \textit{`trying to ``resurrect'' members of the open ended age group and simultaneously estimate fertility, mortality and migration rates.'} \citep{wheldon2016bayesian}
	\end{itemize}
\end{itemize}
\end{frame}


\begin{frame}
\frametitle{Bayesian Population Reconstruction}
I will be adopting the Bayesian population reconstruction framework by \citet{wheldon2016bayesian}
\begin{itemize}
\item prospective approach
\item Bayesian approach, gives associated uncertainty ranges of the reconstructed population counts
\end{itemize}

The core of this framework is the cohort component method of population projection (CCMPP)
\end{frame}

\begin{frame}
\begin{tikzpicture}[main/.style = {draw=blue, rectangle, inner ysep=3pt,inner xsep=3pt, minimum width= 20mm},
										empty/.style = {rectangle, inner ysep=3pt,inner xsep=3pt, minimum width= 20mm}] 

\node[main] (01) {$N_{0, t}$};
\node[main, right=2cm of 01] (02) {$N_{0, t+1}$};
\node[main, right=2cm of 02] (03) {$N_{0, t+2}$};

\node[main, below=1.5cm of 01](11){$N_{x,t}$};
\node[main, below=0cm of 11](21){$N_{x+1,t}$};

\node[main, right=2cm of 21](12){$N_{x+1,t+1}$};
\node[main, below=0cm of 12](22){$N_{x+2,t+1}$};

\node[main, right=2cm of 22](13){$N_{x+2,t+2}$};
\node[main, below=0cm of 13](23){$N_{x+3,t+2}$};

\node[main, below=3cm of 21](end1){$N_{oag-1,t}$};
\node[main, below=0cm of end1](oag1){$N_{oag,t}$};

\node[main, right=2cm of end1](end2){$N_{oag-1,t+1}$};
\node[main, below=0cm of end2](oag2){$N_{oag,t+1}$};
\node[main, right=2cm of end2](end3){$N_{oag-1,t+2}$};
\node[main, below=0cm of end3](oag3){$N_{oag,t+2}$};

\node[main, above=0.5cm of (01)](minus1){$B_t$};

\path(01)--(11) node[empty, midway](1dots1) {$\vdots$};
\path(21)--(end1) node[empty, midway](2dots1) {$\vdots$};
\path(02)--(12) node[empty, midway](1dots2) {$\vdots$};
\path(22)--(end2) node[empty, midway](2dots2) {$\vdots$};
\path(03)--(13) node[empty, midway](1dots3) {$\vdots$};
\path(23)--(end3) node[empty, midway](2dots3) {$\vdots$};

\draw[thick, ->] (11)--(12);
\draw[thick, ->] (21)--(22);
\draw[thick, ->] (12)--(13);
\draw[thick, ->] (22)--(23);

\draw[thick, ->] (end1)--(oag2);
\draw[thick, ->] (oag1)--(oag2);
\draw[thick, ->] (end2)--(oag3);
\draw[thick, ->] (oag2)--(oag3);

\draw[red, thick, ->](11) to [out=0, in =-178, looseness=1.3] (02);
\draw[red, thick, ->](21) to [out=0, in =-175, looseness=1.2] (02);
\draw[red, thick, ->](2dots1) to [out=0, in =-172, looseness=1] (02);

\end{tikzpicture}
\end{frame}

\bibliographystyle{apalike}
\bibliography{Ref}

\end{document}